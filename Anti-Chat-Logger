-- This basically makes roblox unable to log your chat messages sent in-game. Meaning if you get reported for saying something bad, you won't get banned!
-- Store the loadstring (line 5) in your autoexec folder into a text/lua file to receive automatic updates [remove the "--"" part when you paste it into the text file]
-- Credits: AnthonyIsntHere

-- loadstring(game:HttpGet("https://raw.githubusercontent.com/vqmpjayZ/More-Scripts/main/Anti-Chat-Logger", true))()

--(DD/MM/YY)
-- 17.7.2024 - Rewritten
-- 18.4.2024 - TextChatService Support
-- 4.8.2024 - Notifications for execution on TCS + fixed legacy vrs
-- 5.8.2024 - Added Anti Screenshot logger (oops)
-- 7.8.2024 - Reworked + Added Support to Delta + Fixed /e commands not working
-- 9.8.2024 - Reworked (again) + fixed textbox not getting cleared when using /e commands
-- 11.8.2024 - Fixed the notifications
-- 12-8.2024 - Fixed Legacy (again)

--https://dsc.gg/vadriftz

if not game:IsLoaded() then
    game.Loaded:Wait()
end

local Players = game:GetService("Players")
local StarterGui = game:GetService("StarterGui")
local LocalPlayer = Players.LocalPlayer

local hasExecuted = LocalPlayer:FindFirstChild("HasExecuted")
if not hasExecuted then
    hasExecuted = Instance.new("BoolValue")
    hasExecuted.Name = "HasExecuted"
    hasExecuted.Value = false
    hasExecuted.Parent = LocalPlayer
end

local startTime = tick()

local function showNotification(title, description, imageId)
    StarterGui:SetCore("SendNotification", {
        Title = title;
        Text = description;
        Icon = imageId;
        Duration = 15;
    })
end

local function executeScript()
    if hasExecuted.Value then
        showNotification("Vadrifts ACL", "Anti Chat and Screenshot logger already loaded!", "rbxassetid://2541869220")
        print("Anti Chat Logger already loaded!")
        return
    end

    hasExecuted.Value = true

    local ACLloadTime = tick() - startTime

    showNotification("Vadrifts ACL", string.format("Anti Chat & Screenshot logger loaded in %.2fs", ACLloadTime), "rbxassetid://2541869220")
    print(string.format("Anti Chat Logger successfully loaded in %.2f seconds!", ACLloadTime))

    if setfflag then
        pcall(function()
            setfflag("AbuseReportScreenshot", "False")
            setfflag("AbuseReportScreenshotPercentage", "0")
        end) --anti screenshot logger
    end

    local function AntiChatLog(message)
        if message:sub(1, 2) == "/e" then
            return message
        else
            return message .. ""
        end
    end

    local function onMessageSent(message)
        local modifiedMessage = AntiChatLog(message.Text)
        message.Text = modifiedMessage
    end

    if TCS then
        TCS.OnIncomingMessage = function(message)
            onMessageSent(message)
        end
    else
        print("TextChatService not available")
    end
end

local TCS = game:GetService("TextChatService")
local isLegacy = TCS.ChatVersion == Enum.ChatVersion.LegacyChatService

if isLegacy then
    -- Credits: AnthonyIsntHere
    local success, errorMsg = pcall(function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/vqmpjayZ/More-Scripts/main/Anthony's%20ACL", true))()
    end)
    
    if not success then
        showNotification("Error", "Failed to load Legacy Chat script: " .. errorMsg, "rbxassetid://2541869220")
        print("Error loading Legacy Chat script: " .. errorMsg)
    end
else
    wait(0.21)
    executeScript()

    local EnabledChat = task.spawn(function()
        repeat
            StarterGui:SetCoreGuiEnabled(Enum.CoreGuiType.Chat, true)
            task.wait()
        until StarterGui:GetCoreGuiEnabled(Enum.CoreGuiType.Chat)
    end)
end
